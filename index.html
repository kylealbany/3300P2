<html>
<head>
    <title>Voting Records & Region Demographics</title>
<!-- Load the d3 library. -->
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<!-- Load d3 Map Data -->
    <script src="http://d3js.org/topojson.v1.min.js"></script>
<!-- Load Google Fonts & CSS -->
    <link href='https://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'>
    <link href='stylesheet.css' rel='stylesheet' type='text/css'>
<!-- Jquery & JS links go here -->
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
</head>

<body>

<div class="body-wrapper">
    <div id="title-card">
        <h1> Voting Records and Region Demographics </h1>
        <hr>
        <h3> An Interactive View into American Political Alignments </h3>
    </div>
    <div id="paragraph">
        <p> This is an introductory paragraph that will explain a few things before we go
        into our main plot. It could potentially explain how to use the graph, and maybe 
        even the rationale as to why we are doing this data visualization in the first place.</p>
    </div>
    <div id="mapholder">
        <div id="map">
        </div>
        <div id="info-box">
            <p> Filtering Options </p>
                <div id="slider"></div>
            <script>
                $(function() {
                    $("#slider").slider();
                });
            </script>
        </div>
    </div>
</div>
<div class="body-wrapper">
    <hr>
    <p> Bonus stats if we want them... </p>
</div>

<script>
var width = 1000;
var height = 500;


var projection = d3.geo.albersUsa();

var path = d3.geo.path()
	.projection(projection);

var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);

var g = svg.append("g");

d3.json("us.json", function(error, us) {


	g.append("g")
	    .selectAll("path")
    	    .data(topojson.feature(us, us.objects.counties).features)
    	.enter().append("path")
        	.attr("d", path)
        	.style("fill", "cccccc")
        	.style("stroke", "888888")
        	.on('mousedown.log', countyClicked);

	g.append("g")
	    .selectAll("path")
    	    .data(topojson.feature(us, us.objects.states).features)
    	.enter().append("path")
        	.attr("d", path)
        	.style("fill", "cccccc")
        	.style("stroke", "888888")
        	.on('mousedown.log', stateClicked);
	
});

var currentState;

function stateClicked(d) {
	var x, y;
	var zoom = 3;

	if(currentState != null){
		currentState.attr("display", "initial");
	}
	
	currentState = d3.select(this);
	currentState.attr("display", "none");

    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];

	g.transition()
      .duration(1000)
      .attr("transform", "translate(" + width/2 + "," + height/2 + ")scale(" + zoom + ")translate(" + -x + "," + -y + ")");

}

function countyClicked(d){
	console.log(d.id);
}


</script>
</body>
</html>